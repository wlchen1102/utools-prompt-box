# 提示词管理工具实施计划

## 概述

本实施计划基于已确认的需求文档和设计文档，严格按照 uTools 插件开发规范，采用测试驱动开发（TDD）方式，实现一期需求的提示词管理功能。项目采用 Vue 3 + Vite 单页应用架构，直接使用 uTools 原生 API，确保每个步骤都符合 uTools 插件开发标准。

**注意：本计划仅实现一期需求，不包含提示词广场、分享、审核等二期功能。**

## 任务列表

### 1. 项目基础设施搭建 ✅ **已完成**

- [x] 1.1 创建 uTools Vue 插件基础结构 ✅ **已完成 2025-01-22**
  - ✅ 使用 Vue3 + Vite + TypeScript 创建项目
  - ✅ 配置 plugin.json 插件配置文件
  - ✅ 创建 preload.js 预加载脚本文件  
  - ✅ 设置符合 uTools 规范的目录结构
  - ✅ 复制 logo.png 到项目目录
  - ✅ 修复 preload 路径配置问题
  - ✅ 修复 preload.js 文件编码问题（UTF-8）
  - **需求引用**: uTools 插件开发规范

- [x] 1.2 配置 uTools 开发环境 ✅ **已完成 2025-01-22**
  - ✅ 安装和配置 Naive UI 组件库（确保无外部 CDN 依赖）
  - ✅ 集成 Pinia 状态管理，配置直接调用 uTools API
  - ✅ 配置 Vue Router 路由系统（用于页面切换）
  - ✅ 设置 uTools API 类型定义文件和全局声明 (src/types/utools.d.ts)
  - ✅ 配置开发环境和 uTools 窗口集成
  - **需求引用**: 要求5.1 (uTools 本地数据库存储)

- [x] 1.3 建立主题色彩系统 ✅ **已完成 2025-01-22**
  - ✅ 创建 CSS 变量定义文件，设置主题色 #00B25A (src/styles/theme.css)
  - ✅ 配置 Naive UI 主题定制 (src/config/theme.ts)
  - ✅ 实现明显卡片阴影效果的样式类
  - ✅ 创建全局样式文件和辅助类
  - **需求引用**: 设计规范 (主题色彩 #00B25A, 卡片阴影效果)

### 2. 核心数据模型和存储层 ✅ **已完成**

- [x] 2.1 定义 TypeScript 数据类型 ✅ **已完成 2025-01-22**
  - ✅ 创建 types/Prompt.ts - 定义 Prompt 接口和 DTO 类型
  - ✅ 创建 types/Tag.ts - 定义 Tag 接口和 DTO 类型，包含10种颜色配置
  - ✅ 创建 types/AppState.ts - 定义应用配置和状态类型
  - ⚠️ 编写类型验证的单元测试 (待后续进行)
  - **需求引用**: 要求4.8 (提示词字段定义), 要求3.9 (标签颜色分类)

- [x] 2.2 实现 uTools API 封装层 ✅ **已完成 2025-01-22**
  - ✅ 创建 utils/utoolsAPI.ts - 封装 utools.db、utools.copyText 等原生 API
  - ✅ 实现 UtoolsDB 类的数据增删改查方法（直接调用 utools.db）
  - ✅ 实现数据备份和恢复功能（使用 utools.db 导出导入）
  - ✅ 支持开发环境 localStorage 模拟
  - ⚠️ 编写 uTools API 集成测试 (待后续进行)
  - **需求引用**: 要求5.1-5.4 (数据存储功能)

- [x] 2.3 实现数据验证器 ✅ **已完成 2025-01-22**
  - ✅ 创建 utils/validators.ts - 实现数据验证逻辑
  - ✅ 实现 Prompt 和 Tag 的验证规则
  - ✅ 实现错误处理和用户友好的错误消息
  - ✅ 支持创建、更新、完整性验证
  - ⚠️ 编写验证器的单元测试 (待后续进行)
  - **需求引用**: 要求4.7 (删除前确认), 要求9.5 (错误处理)

### 3. 基础组件开发 ✅ **已完成**

- [x] 3.1 开发应用根组件和布局 ✅ **已完成 2025-01-23**
  - ✅ 创建 App.vue - uTools 插件主入口组件
  - ✅ 创建主布局组件，包含导航和路由视图（集成在 App.vue 中）
  - ✅ 实现导航标签切换（提示词管理、提示词广场）
  - ✅ 实现路由切换逻辑和主题色高亮的导航状态
  - ✅ 更新路由配置，添加 MarketplaceView 路由
  - **需求引用**: 要求1.1-1.5 (用户界面布局)

- [x] 3.2 创建提示词广场占位页面 ✅ **已完成 2025-01-23**
  - ✅ 创建 MarketplaceView.vue 组件（作为路由页面）
  - ✅ 实现"正在开发中"的缺省状态设计
  - ✅ 添加缺省图标和提示文案
  - ✅ 添加功能预告列表和返回导航
  - ✅ 采用渐变背景和卡片式布局设计
  - **需求引用**: 要求1.5 (提示词广场缺省状态)

- [x] 3.3 开发通用 UI 组件 ✅ **已完成 2025-01-23**
  - ✅ 创建 ConfirmDialog.vue - 确认对话框组件
  - ✅ 创建 LoadingSpinner.vue - 加载状态组件  
  - ✅ 创建 EmptyState.vue - 空状态组件
  - ✅ 实现完整的 TypeScript 类型定义
  - ✅ 包含动画效果和响应式设计
  - ⚠️ 编写组件的单元测试 (待后续进行)
  - **需求引用**: 要求9.2 (操作反馈), 要求4.7 (删除确认)

### 4. 标签管理功能实现 ✅ **已完成**

- [x] 4.1 开发标签面板组件 ✅ **已完成 2025-01-23**
  - ✅ 创建 TagPanel.vue - 左侧标签面板组件（20%宽度）
  - ✅ 实现"全部"按钮，默认选中状态
  - ✅ 实现标签列表展示，最多6个字符宽度，超过换行
  - ✅ 实现标签选中状态的视觉反馈（#00B25A 主题色高亮）
  - ✅ 实现标签的悬浮操作按钮（编辑、删除）
  - **需求引用**: 要求2.1-2.2, 要求3.1-3.4 (标签面板布局和筛选)

- [x] 4.2 实现标签 CRUD 操作 ✅ **已完成并优化 2025-01-23**
  - ✅ 创建 TagDialog.vue - 标签编辑对话框组件
  - ✅ 实现标签的新增功能和表单验证
  - ✅ 实现标签的编辑功能，支持名称和颜色修改
  - ✅ 实现标签的删除功能，显示关联提示词数量确认
  - ✅ 处理删除标签时移除提示词关联但保留提示词本身
  - ✅ 集成10种颜色选择和表单验证
  - ✅ **UI优化**: 标签长度20字符，显示8字符+省略号
  - ✅ **交互优化**: 悬浮显示横向三点菜单，点击显示下拉操作
  - ✅ **数据修复**: 编辑时正确初始化原始标签数据
  - **需求引用**: 要求3.5-3.8 (标签增删改)

- [x] 4.3 开发标签服务层 ✅ **已完成 2025-01-23**
  - ✅ 创建 services/TagService.ts - 标签业务逻辑
  - ✅ 实现标签数据的持久化存储（基于 uTools DB）
  - ✅ 实现标签和提示词的关联关系管理
  - ✅ 实现标签搜索、统计、导入导出功能
  - ⚠️ 编写标签服务的单元测试和集成测试 (待后续进行)
  - **需求引用**: 要求3.1-3.9 (标签功能模块)

### 5. 提示词卡片系统开发

- [ ] 5.1 开发提示词卡片组件
  - 创建 PromptCard.vue - 提示词卡片组件
  - 实现卡片的明显阴影效果样式
  - 展示提示词标题、标签、内容预览等信息
  - 实现查看、复制、编辑、删除功能按钮
  - **需求引用**: 要求4.2-4.3 (卡片展示和操作按钮)

- [ ] 5.2 实现卡片操作功能
  - 实现查看功能 - 展示完整内容并支持 Markdown 渲染
  - 实现复制功能 - 一键复制 Markdown 格式内容到剪贴板
  - 实现编辑功能 - 打开编辑弹窗修改提示词信息
  - 实现删除功能 - 删除前确认对话框
  - **需求引用**: 要求4.4-4.7 (卡片功能操作)

- [ ] 5.3 开发卡片网格布局
  - 创建 CardGrid.vue - 卡片网格容器组件
  - 实现响应式网格布局，适配不同窗口大小
  - 实现卡片的拖拽排序功能（可选）
  - 编写网格布局的渲染测试
  - **需求引用**: 要求4.9 (卡片排序), 要求9.1 (响应式设计)

### 6. 提示词管理核心功能

- [ ] 6.1 开发搜索功能组件
  - 创建 SearchBar.vue - 搜索栏组件
  - 实现根据名称和内容的模糊搜索
  - 实现搜索防抖机制（500ms 延迟）
  - 实现搜索历史记录功能
  - **需求引用**: 要求4.1 (搜索功能), 要求10.2 (搜索响应时间)

- [ ] 6.2 实现提示词 CRUD 操作
  - 创建 PromptDialog.vue - 提示词编辑弹窗
  - 实现新增提示词功能，包含名称、内容、标签、来源字段
  - 实现编辑提示词功能，支持修改所有字段
  - 实现表单验证和错误提示
  - **需求引用**: 要求4.6-4.8 (提示词编辑和新增)

- [ ] 6.3 开发提示词服务层
  - 创建 services/PromptService.ts - 提示词业务逻辑
  - 实现提示词的增删改查功能
  - 实现按标签筛选和搜索功能
  - 编写提示词服务的单元测试
  - **需求引用**: 要求4.1-4.9 (提示词卡片功能)

### 7. 状态管理和数据流

- [ ] 7.1 创建 Pinia 状态存储
  - 创建 stores/promptStore.ts - 提示词状态管理
  - 创建 stores/tagStore.ts - 标签状态管理
  - 创建 stores/appStore.ts - 应用配置状态管理
  - 实现状态的持久化同步
  - **需求引用**: 要求9.4 (记住用户偏好)

- [ ] 7.2 实现数据响应式更新
  - 实现标签选择时的提示词筛选联动
  - 实现搜索关键词的实时筛选
  - 实现新增/编辑/删除操作的状态同步
  - 编写状态管理的集成测试
  - **需求引用**: 要求3.2-3.3 (标签筛选联动)

- [ ] 7.3 优化性能和用户体验
  - 实现虚拟滚动优化大量数据展示
  - 实现操作成功/失败的用户反馈提示
  - 实现加载状态的显示
  - 添加操作防抖和节流优化
  - **需求引用**: 要求9.2 (操作反馈), 要求10.3-10.5 (性能要求)

### 8. 主页面集成和路由

- [x] 8.1 开发提示词管理主页面 ✅ **已完成 2025-01-23**
  - ✅ 重新设计 HomeView.vue - 主页面组件
  - ✅ 集成标签面板和卡片网格的左右分栏布局（20% : 80%）
  - ✅ 实现顶部工具栏（搜索框、添加按钮、提示词计数）
  - ✅ 实现基础的组件间数据传递和事件通信结构
  - ✅ 确保布局的响应式适配
  - ✅ 添加空状态展示和提示词卡片基础结构
  - **需求引用**: 要求2.1-2.5 (提示词管理页面布局)

- [x] 8.2 配置路由系统 ✅ **已完成 2025-01-23**
  - ✅ 配置 Vue Router 路由规则（提示词管理、提示词广场）
  - ✅ 实现页面间的导航逻辑和路由元信息
  - ✅ 集成导航标签与路由状态的联动
  - ✅ 确保路由与 uTools 窗口行为的兼容性
  - ⚠️ 实现路由状态的记忆和恢复 (待后续进行)
  - **需求引用**: 要求1.1-1.3 (导航系统)

- [ ] 8.3 实现组件间通信
  - 建立父子组件的 props 和 emits 通信
  - 实现跨组件的状态共享
  - 处理异步操作的状态同步
  - 编写组件集成测试
  - **需求引用**: 全局状态管理需求

### 9. uTools 平台集成

- [ ] 9.1 完善 uTools 插件配置
  - 完善 plugin.json 的 features 配置，设置关键词触发
  - 配置插件图标和描述信息
  - 设置插件的快捷方式和触发条件
  - 验证插件配置的正确性
  - **需求引用**: uTools 插件规范要求

- [ ] 9.2 优化 uTools 集成体验
  - 实现插件窗口的适配和响应式布局
  - 优化复制操作的用户反馈（使用 utools.showNotification）
  - 实现插件的快捷键支持
  - 处理插件的显示和隐藏逻辑
  - **需求引用**: 要求5.1 (uTools 数据库), 要求4.5 (剪贴板复制)

- [ ] 9.3 构建 uTools 插件包
  - 配置 Vite 构建输出符合 uTools 插件要求
  - 创建 .upx 插件包生成脚本
  - 验证插件包的完整性和可安装性
  - 优化插件包大小和加载性能
  - **需求引用**: 要求7.1 (插件启动时间)

### 10. 测试和质量保证

- [ ] 10.1 编写单元测试
  - 为所有工具函数编写单元测试
  - 为所有服务类编写单元测试
  - 为数据验证器编写测试用例
  - 确保测试覆盖率达到 80% 以上
  - **测试框架**: Vitest + Vue Test Utils

- [ ] 10.2 编写组件测试
  - 为所有 Vue 组件编写渲染测试
  - 测试组件的 props 和 emits 功能
  - 测试用户交互事件的处理
  - 测试组件的响应式行为
  - **测试工具**: @vue/test-utils + jsdom

- [ ] 10.3 编写集成测试
  - 测试组件间的数据流和通信
  - 测试状态管理的完整流程
  - 测试 uTools API 集成功能
  - 测试数据持久化和恢复流程
  - **集成范围**: 完整用户操作流程

### 11. 性能优化和用户体验

- [ ] 11.1 实现性能优化
  - 实现大数据量的虚拟滚动
  - 优化搜索功能的防抖处理
  - 实现组件的懒加载
  - 优化 bundle 大小和加载速度
  - **需求引用**: 要求10.2-10.5 (性能要求)

- [ ] 11.2 完善用户体验
  - 实现操作的加载状态和成功提示
  - 添加键盘快捷键支持
  - 实现错误状态的友好提示
  - 优化移动设备的触摸交互
  - **需求引用**: 要求9.1-9.5 (用户体验优化)

- [ ] 11.3 实现数据管理功能
  - 基于 utools.db 实现数据导出功能
  - 实现数据导入恢复功能（JSON格式）
  - 添加数据完整性验证
  - 利用 uTools 云同步特性自动备份数据
  - **需求引用**: 要求5.2-5.3 (数据备份和云同步)

### 12. 最终集成和发布准备

- [ ] 12.1 完整功能测试
  - 执行完整的用户场景测试
  - 验证所有功能的正确性
  - 测试插件在 uTools 环境中的稳定性
  - 进行跨平台兼容性测试
  - **验证范围**: 所有需求文档中的功能点

- [ ] 12.2 代码质量检查
  - 运行 ESLint 和 Prettier 检查
  - 确保 TypeScript 类型检查无错误
  - 执行完整的测试套件
  - 进行代码 review 和重构
  - **质量标准**: 零 linting 错误，90%+ 测试覆盖率

- [ ] 12.3 构建发布版本
  - 构建优化的生产版本（确保符合 uTools 要求）
  - 生成标准的 uTools 插件包 (.upx)
  - 在 uTools 环境中测试插件包的安装和运行
  - 准备插件的使用说明和开发文档
  - **交付物**: 可在 uTools 中安装使用的插件包

## 开发优先级

### 高优先级（核心功能）
- 任务 1-3：项目基础和基础组件
- 任务 4-6：标签管理和提示词管理核心功能
- 任务 7-8：状态管理和页面集成

### 中优先级（增强功能）
- 任务 9：uTools 平台深度集成
- 任务 10：测试覆盖
- 任务 11：性能优化

### 低优先级（完善功能）
- 任务 12：最终集成和发布准备
- 高级 UI 交互和动画效果
- 扩展功能（如批量操作、高级搜索等）

## 里程碑检查点

1. **M1 - 基础框架完成** ✅ **已达成 2025-01-23**：任务 1-3 完成，基础 UI 框架就绪
   - ✅ 项目基础设施搭建完成
   - ✅ 核心数据模型和存储层完成  
   - ✅ 基础组件开发完成
   - ✅ 应用布局和路由系统完成
2. **M2 - 核心功能完成**：任务 4-6 完成，基本的增删改查功能可用
3. **M3 - 主要功能集成**：任务 7-8 完成，完整的用户流程可用
4. **M4 - 生产就绪**：任务 9-12 完成，可发布的稳定版本

每个里程碑都应该包含功能演示和回归测试，确保项目按预期进度推进。 